---
title: "8.3 Assignment: Fit a Logistic Regression Model to Previous Dataset"
author: "Dan Siegel"
date: July 22, 2018
output:
  word_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(httr)
library(ggplot2)
library(dplyr) 
library(readr)
library(class)
library(caret)
library(gmodels)
library(cluster)
library(fpc)
library(foreign)
library(date)
library(ROCR)
binary_data <- read_csv("http://content.bellevue.edu/cst/dsc/520/id/resources/binary-classifier-data.csv")
ind <- createDataPartition(binary_data$label, p=0.70, list=FALSE)
dat_train <- binary_data[ind,]       
dat_test <- binary_data[-ind,]        
binary_log <- glm(label~ x + y, data=dat_train)
binary_pred <- predict(binary_log, dat_test, type = "response")
dat_train <- binary_data[ind,]       
dat_test <- binary_data[-ind,]    
```

# 8.3 Assignment: Fit a Logistic Regression Model to Previous Dataset
## a. What is the accuracy of the logistic regression classifier?

```{r message=TRUE, echo=TRUE}
confusionMatrix(table(data = as.numeric(binary_pred>0.5), reference = dat_test$label))
```

## # b. How does the accuracy of the logistic regression classifier compare to the nearest neighbors algorithm?

```{r echo=TRUE, message=TRUE}
binary_knn <- knn(dat_train[,-1], dat_test[,-1], factor(dat_train$label), k=5, prob=TRUE)
confusionMatrix(table(binary_knn, dat_test$label))
```

## c. Why is the accuracy of the logistic regression classifier different from that of the nearest neighbors?
1) Logistic regression predicts probabilities, which are a measure of the confidence of prediction. k-nearest neighbors predicts just the labels.
2.) Logistic regression assumes is that there is one smooth linear decision boundary. The data is clearly in clusters, and a little bit of EDA would help us determine which algorithm would be the best fit for this data. 

```{r echo=FALSE, message=TRUE}
ggplot(binary_data, aes(x, y, col=factor(label)))+geom_point()
```
Looking at this data, there isn't a single line we could put through and get the all the classifiers. Linear(or logistic) is simply not a good predictor of this data. 
